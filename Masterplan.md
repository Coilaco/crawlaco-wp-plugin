# Crawlaco WordPress Plugin Masterplan

## 1. App Overview and Objectives
The **Crawlaco WordPress Plugin** acts as a bridge between a user’s WordPress/WooCommerce website and the **Crawlaco dashboard**. It simplifies communication between the two systems by handling API key generation, data synchronization, and attribute mapping. The plugin ensures seamless integration, enabling users to manage their websites efficiently through the Crawlaco dashboard.

### Key Objectives:
- Simplify the connection process between WordPress/WooCommerce and Crawlaco.
- Automate the generation and management of API keys.
- Enable data synchronization for articles, products, and attributes.
- Provide a user-friendly interface for setup and configuration.

---

## 2. Target Audience
- **Primary Users**: WordPress site owners who use WooCommerce and want to integrate with the Crawlaco dashboard.
- **Secondary Users**: Developers who may extend the plugin for custom use cases.

---

## 3. Core Features and Functionality
### Step 1: WebsiteKey Validation
- Users enter a **WebsiteKey** generated by the Crawlaco dashboard.
- The plugin validates the key by sending a **GET** request to `/websites/plugin/websites/` with `website-key` and `website-address` headers.
- Displays success or error messages based on the response.
- **On Success**:
  - Save the step state and redirect the user to **Step 2**.

### Step 2: Send API Key Metadata
- Generates and sends **WordPress API Key** and **WooCommerce API Key** (if WooCommerce is installed) to the Crawlaco backend.
- Stores API keys securely in the database.
- **On Success**:
  - Save the step state and redirect the user to **Step 3**.

### Step 3: Fetch Essential Data
- Initiates data fetching by sending a `POST` request to `/websites/plugin/fetch-all/`.
- Polls the task status every **3 seconds** using the `taskId`.
- Handles task statuses (`success`, `failed`, `pending`) and displays appropriate messages.
- **On Success**:
  - Save the step state and redirect the user to **Step 4**.

### Step 4: Map Product Attributes
- Displays a table for mapping product attributes (Size, Color, Brand).
- Sends mapped attributes to `/websites/plugin/meta-data/`.
- Finalizes the setup by sending a `PATCH` request to mark the plugin as active.
- **On Success**:
  - Save the step state and redirect the user to the **Final Step**.

### Final Step: Completion
- Displays a thank-you message and a **“Login to Crawlaco Dashboard”** button.
- **On Success**:
  - Save the step state and display the final success message.

---

## 4. Development Phases or Milestones
### Phase 1: Core Setup
- Implement the basic plugin structure and WebsiteKey validation.
- **Outcome**: Users can validate their WebsiteKey and proceed to the next step.

### Phase 2: API Key Management
- Automate the generation and management of API keys.
- **Outcome**: API keys are generated and sent successfully.

### Phase 3: Data Synchronization
- Enable data fetching and synchronization.
- **Outcome**: Essential data is fetched successfully.

### Phase 4: Map Product Attributes
- Allow users to map product attributes (Size, Color, Brand).
- **Outcome**: Product attributes are mapped, and the plugin is marked as active.

### Phase 5: Plugin Pages and Menu Integration
- Implement the plugin’s home, settings, and status pages.
- **Outcome**: Users can access plugin pages and view/modify settings.

### Phase 6: Polish and Testing
- **Objective**: Fix style issues, improve design, and review the project code.
- **Tasks**:
  1. Section one:
    - **Fix Style Issues**:
      - Make sure all WordPress-related notifications are displayed outside of the **Crawlaco admin box**.
      - Use the plugin’s **main colors** (white, blue, purple) consistently.
      - Apply more creativity in the design of tables, pages, and setup wizard steps.
  2. Section two:
    - **Code Review**:
      - Remove duplicate code from the project core (if any).
      - Ensure the logic of the program is not broken during code cleanup.
      - Fix any bugs or performance issues.
- **Outcome**: The plugin has a polished design, optimized code, and is ready for deployment.

### Phase 7: Deployment
- Publish the plugin to the WordPress repository.
- Add documentation and support links.
- **Outcome**: The plugin is publicly available, and users can install and use it seamlessly.

---

## 5. Potential Challenges and Solutions
### Challenge 1: WooCommerce Compatibility
- **Solution**: Use WordPress’s built-in functions to detect WooCommerce and handle cases where it’s not installed.

### Challenge 2: Task Polling Performance
- **Solution**: Optimize polling logic and set a timeout to prevent infinite loops.

### Challenge 3: RTL and Persian Support
- **Solution**: Use RTL-compliant CSS frameworks and ensure all text is translatable.

---

## 6. Future Expansion Possibilities
- **Webhook Support**: Add real-time updates via webhooks.
- **Additional Integrations**: Extend the plugin to support other eCommerce platforms or SEO plugins.
- **Advanced Analytics**: Provide insights into data synchronization and performance.

---

## 7. Additional Notes
### Warning Notification
- Until the user completes all four steps, a **warning notification** will be displayed at the top of the WordPress dashboard.

### Plugin Activation Hook
- Include a **plugin activation hook** in the plugin core. For example:
  ```php
  register_activation_hook(__FILE__, 'crawlaco_plugin_activation');
  function crawlaco_plugin_activation() {
      // Code to execute on plugin activation
  }

### Logging
- Use WordPress’s default logger for error logging.